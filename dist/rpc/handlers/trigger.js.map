{"version":3,"sources":["../../../src/rpc/handlers/trigger.js"],"names":["trigger","request","proxy","wrapper","operation","params","appContextPool","get","address","APP_CONTEXTS","TRIGGER","eventName","data","slice","emit","event","returnValues","Promise","resolve","reject","Error"],"mappings":";;;;;;;AAAA;;AAEe,SAASA,OAAT,CAAkBC,OAAlB,EAA2BC,KAA3B,EAAkCC,OAAlC,EAA2C;AACxD,QAAM,CAACC,SAAD,IAAcH,OAAO,CAACI,MAA5B;;AAEA,MAAID,SAAS,KAAK,SAAlB,EAA6B;AAC3B,WAAOD,OAAO,CAACG,cAAR,CAAuBC,GAAvB,CAA2BL,KAAK,CAACM,OAAjC,EAA0CC,mBAAaC,OAAvD,CAAP;AACD;;AACD,MAAIN,SAAS,KAAK,MAAlB,EAA0B;AACxB,UAAM,CACJO,SADI,EAEJC,IAFI,IAGFX,OAAO,CAACI,MAAR,CAAeQ,KAAf,CAAqB,CAArB,CAHJ;AAKAV,IAAAA,OAAO,CAACG,cAAR,CAAuBQ,IAAvB,CACEZ,KAAK,CAACM,OADR,EAEEC,mBAAaC,OAFf,EAGE;AACA;AACEK,MAAAA,KAAK,EAAEJ,SADT;AAEE;AACAK,MAAAA,YAAY,EAAEJ,IAAI,IAAI;AAHxB,KAJF;AAUA,WAAOK,OAAO,CAACC,OAAR,EAAP;AACD;;AAED,SAAOD,OAAO,CAACE,MAAR,CACL,IAAIC,KAAJ,CAAU,2BAAV,CADK,CAAP;AAGD","sourcesContent":["import { APP_CONTEXTS } from '../../apps'\n\nexport default function trigger (request, proxy, wrapper) {\n  const [operation] = request.params\n\n  if (operation === 'observe') {\n    return wrapper.appContextPool.get(proxy.address, APP_CONTEXTS.TRIGGER)\n  }\n  if (operation === 'emit') {\n    const [\n      eventName,\n      data\n    ] = request.params.slice(1)\n\n    wrapper.appContextPool.emit(\n      proxy.address,\n      APP_CONTEXTS.TRIGGER,\n      // Mimic web3.js@1's event schema\n      {\n        event: eventName,\n        // `returnValues` is always a object for real Ethereum events\n        returnValues: data || {}\n      }\n    )\n    return Promise.resolve()\n  }\n\n  return Promise.reject(\n    new Error('Invalid trigger operation')\n  )\n}\n"],"file":"trigger.js"}